(()=>{"use strict";var e={45:(e,t,n)=>{n.r(t)},667:(e,t,n)=>{n.r(t)},823:(e,t,n)=>{n.r(t)},315:(e,t,n)=>{n.r(t)},622:(e,t,n)=>{n.r(t)},557:(e,t,n)=>{n.r(t)},403:(e,t,n)=>{n.r(t)},813:(e,t,n)=>{n.r(t)},454:(e,t,n)=>{n.r(t)},284:(e,t,n)=>{n.r(t)},675:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(814));t.default=class{render(){(new r.default).renderView()}}},614:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.stoppedAnimationStorage=new Map,this.requestIDStorage=new Map}getElemPosition(e){return{car:document.getElementById(`car-${e}`),finish:document.getElementById(`finish-${e}`)}}animateCar(e,t){const{car:n,finish:a}=this.getElemPosition(e),r=n.getBoundingClientRect().x+n.getBoundingClientRect().width/2,s=a.getBoundingClientRect().x+a.getBoundingClientRect().width/2-50-r,i=t.distance/t.velocity;let o,l,u=!1;const c=t=>{o||(o=t);const a=t-o;if(l!==t){const e=Math.min(s/i*a,s);n.style.transform=`translateX(${e}px)`,e===s&&(u=!0)}if(a<i&&(l=t,!u)){if(!Number.isFinite(i))return window.cancelAnimationFrame(this.requestIDStorage.get(e)),void this.requestIDStorage.set(e,0);this.requestIDStorage.set(e,window.requestAnimationFrame(c))}};this.requestIDStorage.set(e,window.requestAnimationFrame(c))}}},448:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(174)),s=a(n(323));t.default=function(e,t){return e&&t?{name:e,color:t}:{name:(0,r.default)(),color:(0,s.default)()}}},597:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(150)),s=a(n(361)),i=a(n(448)),o=a(n(739));t.default=class{constructor(){this.control=r.default.createElement({elementType:"div",attributes:{class:"menu__garage-control box"},elements:this.getButtonsControl()})}getButtonsControl(){const e=r.default.createElement({elementType:"button",text:"race",attributes:{class:"menu__button",id:"race"}}),t=r.default.createElement({elementType:"button",text:"reset",attributes:{class:"menu__button disabled",id:"reset"}}),n=r.default.createElement({elementType:"button",text:"generate 100 cars",attributes:{class:"menu__button",id:"generate-cars"}});return n.addEventListener("click",(()=>{this.generateCars()})),[e,t,n]}async generate100Cars(){const e=new s.default,t=[];for(let n=0;n<100;n+=1)t.push(e.createCarAPI((0,i.default)()));return Promise.all(t)}renderControl(){return this.control}async generateCars(){const e=new o.default;await this.generate100Cars(),await e.updatePage("Garage")}}},720:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(150)),s=a(n(597));t.default=class{constructor(){const e=new s.default;this.menu=r.default.createElement({elementType:"div",attributes:{class:"menu"},elements:[this.getCreateBox(),this.getUpdateBox(),e.renderControl()]})}getCreateBox(){const e=r.default.createElement({elementType:"input",attributes:{class:"menu__input-text",id:"text-create",type:"text"}}),t=r.default.createElement({elementType:"input",attributes:{class:"menu__input-color",id:"color-create",type:"color"}}),n=r.default.createElement({elementType:"button",text:"create car",attributes:{class:"menu__button",id:"create-btn"}});return r.default.createElement({elementType:"div",attributes:{class:"menu__create-box box"},elements:[e,t,n]})}getUpdateBox(){const e=r.default.createElement({elementType:"input",attributes:{class:"menu__input-text disabled",id:"text-update",type:"text"}}),t=r.default.createElement({elementType:"input",attributes:{class:"menu__input-color disabled",id:"color-update",type:"color"}}),n=r.default.createElement({elementType:"button",text:"update car",attributes:{class:"menu__button disabled",id:"btn-update"}});return r.default.createElement({elementType:"div",attributes:{class:"menu__update-box box"},elements:[e,t,n]})}renderMenu(){return this.menu}}},948:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(150)),s=a(n(720)),i=a(n(390)),o=a(n(444)),l=a(n(168));n(45),t.default=class{constructor(e,t){this.page=e,this.value=t;const n=new s.default,a=new i.default,u=new o.default(this.page,this.value),c=new l.default(this.value),d=r.default.createElement({elementType:"div",attributes:{class:"page"},elements:[a.renderCarCount(this.page,this.value),u.renderPagination()]});this.garage=r.default.createElement({elementType:"section",attributes:{class:"garage",id:"garage"},elements:[n.renderMenu(),d,c.getAllTracks()]})}renderGarage(){document.body.append(this.garage)}}},168:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(150)),s=a(n(939));n(667),t.default=class{constructor(e){this.value=e;const t=this.value;this.trackBox=r.default.createElement({elementType:"div",attributes:{class:"garage__track-box",id:"track-box"}});const n=document.getElementById("track-box");n&&n.replaceWith(this.trackBox),t.items.forEach((e=>{this.trackBox.append(this.createTrack(e))}))}createCarName(e){return r.default.createElement({text:`${e.name}`,elementType:"h2",attributes:{class:"track__name"}})}createFinishImg(e){return r.default.createElement({elementType:"img",attributes:{class:"track__finish-img",id:`finish-${e.id}`,alt:"finish-flag",src:"../../../assets/finish.png"}})}createBtnStart(e){return r.default.createElement({elementType:"button",text:"start engine",attributes:{class:"track__start-btn",value:`${e.id}`}})}createBtnStop(e){return r.default.createElement({elementType:"button",text:"stop engine",attributes:{class:"track__stop-btn disabled",value:`${e.id}`}})}createBtnSelect(e){return r.default.createElement({elementType:"button",text:"select",attributes:{class:"track__select-btn",value:`${e.id}`}})}createBtnRemove(e){return r.default.createElement({elementType:"button",text:"remove",attributes:{class:"track__remove-btn",value:`${e.id}`}})}createTrack(e){const t=r.default.createElement({elementType:"div",attributes:{class:"track__control-car"},elements:[this.createBtnSelect(e),this.createBtnRemove(e)]}),n=r.default.createElement({elementType:"div",attributes:{class:"track__control-engine"},elements:[this.createBtnStart(e),this.createBtnStop(e)]}),a=r.default.createElement({elementType:"div",attributes:{class:"track__control"},elements:[t,n,this.createCarName(e)]}),i=r.default.createElement({elementType:"div",attributes:{class:"track__image"}});return i.append((0,s.default)(e,{width:"130px",height:"50px"}),this.createFinishImg(e)),r.default.createElement({elementType:"div",attributes:{class:"garage__track track"},elements:[a,i]})}getAllTracks(){return this.trackBox}}},514:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(150));n(823);const s=a(n(693)),i=n(752);t.default=class{constructor(){this.buttonGarage=r.default.createElement({elementType:"button",text:"garage",attributes:{class:"nav__button",id:"to-garage"}}),this.buttonWinners=r.default.createElement({elementType:"button",text:"winners",attributes:{class:"nav__button",id:"to-winners"}}),this.buttonGarage.addEventListener("click",this.displayPage),this.buttonWinners.addEventListener("click",this.displayPage),this.nav=r.default.createElement({elementType:"nav",attributes:{class:"nav"},elements:[this.buttonGarage,this.buttonWinners]});const e=r.default.createElement({elementType:"h1",text:"ASYNC-RACE",attributes:{class:"header__title"}});this.header=r.default.createElement({elementType:"header",attributes:{class:"header"},elements:[this.nav,e]})}displayPage(e){const t=(0,i.getElementId)(e),n=(0,s.default)("Garage"),a=(0,s.default)("Winners");t.includes("garage")?(n.style.display="flex",a.style.display="none"):(n.style.display="none",a.style.display="block")}renderHeader(){document.body.append(this.header)}}},990:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(361)),s=a(n(150));n(315),t.default=class{async generateModalWindow({id:e,time:t}){const n=new r.default,a=await n.getCarAPI(e),i=s.default.createElement({elementType:"tbody",text:`Winner: ${a.name}\n      Time: ${t} (s)`,attributes:{class:"modal",id:"modal"}});document.body.append(i)}deleteModalWindow(){const e=document.getElementById("modal");e&&e.remove()}}},390:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(150));t.default=class{renderCarCount(e,t){let n=document.getElementById(`page-car-${e.toLowerCase()}`);return n?n.innerText=`${e} [${t.count}]`:n=r.default.createElement({elementType:"h2",text:`${e} [${t.count}]`,attributes:{class:"page-car",id:`page-car-${e.toLowerCase()}`}}),n}}},391:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(757)),s=a(n(150));n(622),t.default=class{renderPageCount(e,t){const n=new r.default;let a=document.getElementById(`page-counter-${e.toLowerCase()}`);const i=n.getCurrentPage(e),o=n.getLastPage(e,t);return a?a.innerText=`${i} | ${o}`:a=s.default.createElement({elementType:"span",text:`${i} | ${o}`,attributes:{class:"page__counter",id:`page-counter-${e.toLowerCase()}`}}),a}}},444:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(150)),s=a(n(391));n(557),t.default=class{constructor(e,t){this.page=e,this.value=t,this.buttonPrev=r.default.createElement({elementType:"button",text:"prev",attributes:{class:"pagination__button disabled",id:`btn-prev-${this.page.toLowerCase()}`}}),this.buttonNext=r.default.createElement({elementType:"button",text:"next",attributes:{class:"pagination__button",id:`btn-next-${this.page.toLowerCase()}`}})}renderPagination(){const e=new s.default;return r.default.createElement({elementType:"div",attributes:{class:"pagination"},elements:[this.buttonPrev,e.renderPageCount(this.page,this.value),this.buttonNext]})}}},814:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(514)),s=a(n(948)),i=a(n(436)),o=a(n(361)),l=a(n(859)),u=a(n(207)),c=n(175);t.default=class{constructor(){this.apiGarage=new o.default,this.apiWinners=new l.default,this.sortAndOrder=new u.default}async renderView(){let e,t;try{t=await this.apiGarage.getCarsAPI(1),e=await this.apiWinners.getWinnersAPI({pageNumber:1,sort:this.sortAndOrder.getSort(),order:this.sortAndOrder.getOrder()});const n=new r.default,a=new s.default("Garage",t),o=new i.default("Winners",e);n.renderHeader(),a.renderGarage(),o.renderWinners(),(0,c.setStartStopBtnsListener)(),(0,c.setRaceBtnListener)(),(0,c.setResetBtnListener)(),(0,c.setCreateCarBtnListener)()}catch(e){throw new Error("Oops, is there something wrong",e)}}}},180:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(939)),s=a(n(757)),i=a(n(150));n(403),t.default=class{constructor(e){this.value=e;const t=this.generateTableHead(),n=i.default.createElement({elementType:"tbody",attributes:{class:"table__body"},elements:[t]});this.table=i.default.createElement({elementType:"table",attributes:{class:"table",id:"table"},elements:[n]});const a=document.getElementById("table");a&&a.replaceWith(this.table),e.items.forEach(((e,t)=>{n.append(this.generateTableRow(e,this.position(t)))}))}position(e){return 10*((new s.default).getCurrentPage("Winners")-1)+e+1}generateTableHead(){const e=i.default.createElement({elementType:"th",text:"Number",attributes:{class:"th"}}),t=i.default.createElement({elementType:"th",text:"Car",attributes:{class:"th"}}),n=i.default.createElement({elementType:"th",text:"Name car",attributes:{class:"th"}}),a=i.default.createElement({elementType:"th",text:"Wins",attributes:{class:"th",id:"wins"}}),r=i.default.createElement({elementType:"th",text:"Best time",attributes:{class:"th",id:"best-time"}});return i.default.createElement({elementType:"tr",attributes:{class:"tr",id:"table-head"},elements:[e,t,n,a,r]})}generateTableRow(e,t){const n=i.default.createElement({elementType:"td",text:`${t}`,attributes:{class:"td"}}),a=(0,r.default)(e.car,{width:"100px",height:"80px"}),s=i.default.createElement({elementType:"td",attributes:{class:"td"}});s.append(a);const o=i.default.createElement({elementType:"td",text:`${e.car.name}`,attributes:{class:"td"}}),l=i.default.createElement({elementType:"td",text:`${e.wins}`,attributes:{class:"td"}}),u=i.default.createElement({elementType:"td",text:`${e.time}`,attributes:{class:"td"}});return i.default.createElement({elementType:"tr",attributes:{class:"tr"},elements:[n,s,o,l,u]})}renderTable(){return this.table}}},553:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=document.getElementById("wins"),a=document.getElementById("best-time"),r="&#9660",s="&#8595";"wins"===e?n.innerHTML="DESC"===t?`Wins ${s}`:`Wins ${r}`:a.innerHTML="DESC"===t?`Best time ${s}`:`Best time ${r}`}},436:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(813);const r=a(n(150)),s=a(n(444)),i=a(n(390)),o=a(n(180));t.default=class{constructor(e,t){this.page=e,this.value=t;const n=new i.default,a=new s.default(this.page,this.value),l=new o.default(t),u=r.default.createElement({elementType:"div",attributes:{class:"winners__box"},elements:[n.renderCarCount(this.page,this.value),a.renderPagination()]});this.winners=r.default.createElement({elementType:"section",attributes:{class:"winners",id:"winners",style:"display: none"},elements:[u,l.renderTable()]})}renderWinners(){document.body.append(this.winners)}}},156:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(454),n(284);const r=a(n(675));window.addEventListener("DOMContentLoaded",(()=>{(new r.default).render()}))},361:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(413));t.default=class{constructor(){this.GARAGE_API=`${r.default}/garage`,this.ENGINE_API=`${r.default}/engine`,this.GARAGE_LIMIT=7}async getCarsAPI(e){const t=await fetch(`${this.GARAGE_API}?_page=${e}&_limit=${this.GARAGE_LIMIT}`),n=t.headers.get("X-Total-Count");if(!n)throw new Error("Total count is null");return{items:await t.json(),count:n}}async getCarAPI(e){return(await fetch(`${this.GARAGE_API}/${e}`)).json()}async deleteCarAPI(e){return(await fetch(`${this.GARAGE_API}/${e}`,{method:"DELETE"})).json()}async updateCarAPI(e,t){return(await fetch(`${this.GARAGE_API}/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json()}async controlEngineAPI(e,t){return(await fetch(`${this.ENGINE_API}?id=${e}&status=${t}`,{method:"PATCH"})).json()}async driveAPI(e){const t=await fetch(`${this.ENGINE_API}?id=${e}&status=drive`,{method:"PATCH"}).catch();return 200!==t.status?{success:!1}:{...await t.json()}}async createCarAPI(e){return(await fetch(this.GARAGE_API,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json()}}},859:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(413)),s=a(n(361));t.default=class{constructor(){this.WINNERS_API=`${r.default}/winners`,this.WINNERS_LIMIT=10}sortOrder(e,t){return e&&t?`&_sort=${e}&_order=${t}`:""}async getWinnersAPI({pageNumber:e,sort:t,order:n}){const a=new s.default,r=await fetch(`${this.WINNERS_API}?_page=${e}&_limit=${this.WINNERS_LIMIT}${this.sortOrder(t,n)}`),i=await r.json(),o=r.headers.get("X-Total-Count");if(!o)throw new Error("X-Total-Count is null");return{items:await Promise.all(i.map((async e=>{const t=await a.getCarAPI(e.id);return{...e,car:t}}))),count:o}}async getWinnerAPI(e){return(await fetch(`${this.WINNERS_API}/${e}`)).json()}async getWinnerStatusAPI(e){return(await fetch(`${this.WINNERS_API}/${e}`)).status}async deleteWinnerAPI(e){return(await fetch(`${this.WINNERS_API}/${e}`,{method:"DELETE"})).json()}async createWinnerAPI(e){return(await fetch(this.WINNERS_API,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json()}async updateWinnerAPI(e){return(await fetch(`${this.WINNERS_API}/${e.id}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})).json()}async saveWinnerAPI({id:e,time:t}){if(404===await this.getWinnerStatusAPI(e))await this.createWinnerAPI({id:e,wins:1,time:t});else{const n=await this.getWinnerAPI(e),a=t<n.time?t:n.time;await this.updateWinnerAPI({id:e,wins:n.wins+1,time:a})}}}},413:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default="http://localhost:3000"},939:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n="http://www.w3.org/2000/svg",{width:a,height:r}=t,s=document.createElementNS(n,"svg");s.id=`car-${e.id}`,s.style.fill=`${e.color}`,s.style.width=a,s.style.height=r,s.style.zIndex="5";const i=document.createElementNS(n,"use");return i.setAttributeNS("http://www.w3.org/1999/xlink","href","./assets/sprite.svg#car"),s.append(i),s}},150:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static createGenericElement({elementType:e,text:t,attributes:n,elements:a}){const r=document.createElement(e);return t&&(r.textContent=t),a&&a.forEach((e=>r.append(e))),n&&Object.entries(n).forEach((([e,t])=>{r.setAttribute(e,t)})),r}static createElement(e){return this.createGenericElement(e)}}},693:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=document.getElementById(`${e.toLowerCase()}`);if(!t)throw new Error("page not found");return t}},752:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaginationElements=t.getUpdateElementsProp=t.getCreateElementsProp=t.getButtonProp=t.getElementId=void 0,t.getElementId=function(e){return e.target.id},t.getButtonProp=function(e){const t=e.target;return{target:t,carId:Number(t.value)}},t.getCreateElementsProp=function(){const e=document.getElementById("text-create"),t=document.getElementById("color-create");if(!e||!t)throw new Error("textInput || colorInput not found");return{name:e.value,color:t.value}},t.getUpdateElementsProp=function(){const e=document.getElementById("text-update"),t=document.getElementById("color-update"),n=document.getElementById("btn-update");if(!e||!t||!n)throw new Error("textInput || colorInput not found");return{textInput:e,colorInput:t,updateBtn:n,name:e.value,color:t.value}},t.getPaginationElements=function(e){const t=document.getElementById(`btn-next-${e.toLowerCase()}`),n=document.getElementById(`btn-prev-${e.toLowerCase()}`);if(!t||!n)throw new Error("updateCarBtn not found");return{paginationNextBtn:t,paginationPrevBtn:n}}},757:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(361)),s=a(n(859));t.default=class{constructor(){this.countGarage=1,this.countWinners=1}setPageCounter(e,t){let n;return n="+"===t?"Garage"===e?this.countGarage+=1:this.countWinners+=1:"Garage"===e?this.countGarage-=1:this.countWinners-=1,n}getCurrentPage(e){return"Garage"===e?this.countGarage:this.countWinners}getLastPage(e,t){const n=new r.default,a=new s.default;let i;return i="Garage"===e?Math.ceil(Number(t.count)/n.GARAGE_LIMIT):Math.ceil(Number(t.count)/a.WINNERS_LIMIT),i}}},174:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(291)),s=a(n(455));t.default=function(){const e=[...r.default],t=[...s.default],n=e=>e[Math.floor(Math.random()*e.length)];return`${n(e)} ${n(t)}`}},323:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){const t=()=>Math.ceil(255*Math.random()),n=t(),a=t(),r=t();let s=`#${n.toString(16)}${a.toString(16)}${r.toString(16)}`;return s.length<7&&(s=e()),s}},175:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setCreateCarBtnListener=t.createCar=t.setRaceBtnListener=t.setResetBtnListener=t.reset=t.race=t.setStartStopBtnsListener=t.drive=t.controlEngine=void 0;const r=a(n(361)),s=n(752),i=a(n(614)),o=a(n(739)),l=a(n(859)),u=a(n(990)),c=a(n(448)),d=new r.default,m=new i.default,f=new o.default,h=new l.default,g=new u.default;t.controlEngine=async(e,t)=>{let n;return e.classList.contains("track__start-btn")?(n="started",e.classList.toggle("disabled"),e.nextElementSibling?.classList.toggle("disabled")):(n="stopped",e.classList.toggle("disabled"),e.previousElementSibling?.classList.toggle("disabled")),{responseEngine:await d.controlEngineAPI(t,n),status:n}},t.drive=async e=>{const{target:n,carId:a}=(0,s.getButtonProp)(e),{responseEngine:r,status:i}=await(0,t.controlEngine)(n,a);if("started"===i){m.animateCar(a,r),m.stoppedAnimationStorage.delete(a);const{success:e}=await d.driveAPI(a);e||m.stoppedAnimationStorage.has(a)||window.cancelAnimationFrame(m.requestIDStorage.get(a))}else m.animateCar(a,r),m.stoppedAnimationStorage.set(a,a)},t.setStartStopBtnsListener=function(){const e=document.querySelectorAll(".track__start-btn"),n=document.querySelectorAll(".track__stop-btn");if(!e.length||!n.length)throw new Error("startBtn || stopBtn doesn't exist");Array.from(e).forEach((e=>e.addEventListener("click",t.drive))),Array.from(n).forEach((e=>e.addEventListener("click",t.drive)))},t.race=async e=>{await f.updatePage("Garage");const n=e.target;n.classList.add("disabled");const a=document.querySelectorAll(".track__start-btn"),r=Array.from(a).map((async e=>{const n=Number(e.value),{responseEngine:a}=await(0,t.controlEngine)(e,n),r=Math.round(a.distance/a.velocity)/1e3;m.animateCar(n,a),m.stoppedAnimationStorage.delete(n);const{success:s}=await d.driveAPI(n);return s||m.stoppedAnimationStorage.has(n)||window.cancelAnimationFrame(m.requestIDStorage.get(n)),s?{success:s,carId:n,time:r}:Promise.reject(new Error(`car starts: #${n}`))}));Promise.any(r).then((async e=>{n.nextElementSibling?.classList.toggle("disabled");const{carId:t,time:a}=e;await h.saveWinnerAPI({id:t,time:a}),await g.generateModalWindow({id:t,time:a}),setTimeout(g.deleteModalWindow,5e3),await f.updatePage("Winners")})).catch((()=>{n.nextElementSibling?.classList.toggle("disabled"),console.log("All cars broken")}))},t.reset=async e=>{const t=e.target;t.classList.add("disabled"),t.previousElementSibling?.classList.toggle("disabled"),await f.updatePage("Garage")},t.setResetBtnListener=()=>{const e=document.getElementById("reset");if(!e)throw new Error("resetBtn doesn't exist");e.addEventListener("click",t.reset)},t.setRaceBtnListener=()=>{const e=document.getElementById("race");if(!e)throw new Error("raceBtn doesn't exist");e.addEventListener("click",t.race)},t.createCar=async()=>{const{name:e,color:t}=(0,s.getCreateElementsProp)();await d.createCarAPI((0,c.default)(e,t)),await f.updatePage("Garage")},t.setCreateCarBtnListener=()=>{const e=document.getElementById("create-btn");if(!e)throw new Error("createCarBtn doesn't exist");e.addEventListener("click",t.createCar)}},291:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Audi","Bentley","BMW","Bugatti","Chevrolet","Chrysler","Continental","Ford","Honda","Hyundai","KIA","Lada","Land Rover","Lexus","Mazda","Mercedes-Benz","Mitsubishi","Nissan","Opel","Renault","Rolls-Royce","Tesla","Toyota","Volvo"]},455:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=["Challenger","Charger","Grand Caravan","X7","X5","X3","X6 M","X6","X1","Duster","CR-V","Corolla","Largus","IS 200t","LS 500h","RX","MX-5 Roadster","Phantom","Camry","Polo","Logan","RAV4","Rio","Solaris"]},207:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.sort="id",this.order="ASC"}setSort(e){return this.sort=e,this.sort}setOrder(e){return this.order=e,this.order}getSort(){return this.sort}getOrder(){return this.order}}},739:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=a(n(361)),s=a(n(859)),i=a(n(168)),o=a(n(553)),l=a(n(390)),u=a(n(391)),c=a(n(180)),d=a(n(757)),m=a(n(207));t.default=class{constructor(){this.apiGarage=new r.default,this.apiWinners=new s.default,this.getPage=new d.default,this.sort=new m.default,this.pageName=new l.default,this.pageCount=new u.default}async updatePage(e){let t;t="Garage"===e?await this.apiGarage.getCarsAPI(this.getPage.getCurrentPage(e)):await this.apiWinners.getWinnersAPI({pageNumber:this.getPage.getCurrentPage(e),sort:this.sort.getSort(),order:this.sort.getOrder()});try{this.pageName.renderCarCount(e,t),this.pageCount.renderPageCount(e,t);const n=document.querySelector(".page"),a=document.getElementById(`page-car-${e.toLowerCase()}`);if("Garage"===e){const e=new i.default(t);n?.after(e.getAllTracks())}else{const e=a.closest(".winners__box");if(e){const n=new c.default(t);e.after(n.renderTable()),(0,o.default)(this.sort.getSort(),this.sort.getOrder())}else console.error("closest .winners__box not found")}return t}catch(e){return console.log("json data is empty"),t}}}}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,n),s.exports}n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(156)})();